{% extends "analysi/base.html" %}
{% load static %}

{% block title %}
Profit Analysis
{% endblock %}

{% block extra_head %}
<style>
  /* ================= PAGE CONTAINER ================= */
  .page-container {
    max-width: 1200px;
    margin: 32px auto;
    padding: 32px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  }

  @media (max-width: 768px) {
    .page-container {
      margin: 16px;
      padding: 20px;
    }
  }

  h1 {
    text-align: center;
    margin-bottom: 32px;
    color: #0f766e;
    font-size: 2.5rem;
    font-weight: 700;
  }

  @media (max-width: 640px) {
    h1 { font-size: 2rem; }
  }

  .section {
    margin-bottom: 40px;
  }

  .section-title {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 16px;
    color: #374151;
    border-left: 5px solid #10b981;
    padding-left: 12px;
  }

  /* ================= TABLE ================= */
  .table-wrapper {
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    overflow-x: auto;
    border: 1px solid #e5e7eb;
  }

  table {
    width: 100%;
    min-width: 720px;
    border-collapse: collapse;
  }

  thead th {
    position: sticky;
    top: 0;
    background: #0d9488;
    color: white;
    font-weight: 600;
    padding: 12px 10px;
    border-right: 1px solid #2dd4bf;
    text-align: center;
    white-space: nowrap;
    font-size: 0.85rem;
    z-index: 10;
  }

  tbody td {
    padding: 12px 10px;
    border-right: 1px solid #d1d5db;
    text-align: center;
    white-space: nowrap;
    font-size: 0.85rem;
  }

  tbody td:first-child,
  tbody td:nth-child(2) {
    font-weight: 600;
    background: #f0fdf4;
    text-align: left;
  }

  tbody tr:nth-child(even) { background: #f9fafb; }
  tbody tr:hover { background: #ecfdf5; }

  .Capacity td { background: #dcfce7 !important; }
  .Financial td { background: #dbeafe !important; }

  .profit-positive { color: #166534; font-weight: 700; }
  .profit-negative { color: #dc2626; font-weight: 700; }

  .no-data {
    text-align: center;
    padding: 48px 24px;
    font-size: 1.125rem;
    color: #6b7280;
    background: #f9fafb;
    border-radius: 12px;
    border: 2px dashed #d1d5db;
  }
</style>
{% endblock %}

{% block content %}

<div class="page-container">

  <h1>ðŸ“Š Profit Analysis</h1>

  {% if box_score_tables %}
    {% for table in box_score_tables %}
      <div class="section">
        <h2 class="section-title">ðŸ“‹ Capacity & Financial Summary</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Section</th>
                <th>Metric</th>
                {% for h in table.headers %}
                  <th>{{ h }}</th>
                {% endfor %}
              </tr>
            </thead>

            <tbody>
              {% for row in table.rows %}
                <tr class="{{ row.section }}">
                  <td>{{ row.section }}</td>
                  <td>{{ row.metric }}</td>
                  {% for v in row.values %}
                    <td>{{ v }}</td>
                  {% endfor %}
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="no-data">ðŸ“­ No Box Score data available</div>
  {% endif %}

  {% if future_predictions %}
    <div class="section">
      <h2 class="section-title">ðŸ”® Future Prediction (Simulated)</h2>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Category</th>
              <th>Current Productive</th>
              <th>Future Productive</th>
              <th>Current Revenue</th>
              <th>Future Revenue</th>
              <th>Expected Profit</th>
            </tr>
          </thead>

          <tbody>
            {% for row in future_predictions %}
              <tr>
                <td><strong>{{ row.category }}</strong></td>
                <td>{{ row.current_productive }}</td>
                <td>{{ row.future_productive }}</td>
                <td>â‚¹{{ row.current_revenue }}</td>
                <td>â‚¹{{ row.future_revenue }}</td>
                <td class="{% if row.future_profit > 0 %}profit-positive{% else %}profit-negative{% endif %}">
                  â‚¹{{ row.future_profit }}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endif %}

</div>

{% endblock %}
